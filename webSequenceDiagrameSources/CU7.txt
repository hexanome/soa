title CU7

Agent->IHM:changerVue(vue)
alt si vue agence
    IHM->SM: getAllAgents(agence)
    activate SM
    SM->Agences: getAll(agence)
    activate Agences
    Agences-->SM: Agents
    deactivate Agences
    SM-->IHM: Agents
    deactivate SM
    Agent->IHM:choixAgent(idAgent)
    Agent->IHM:choixSemaine(date)
    IHM->SM: getSemaineParAgent(semaine,idAgent)
    activate SM
    SM->Agenda: getSemaineParAgent(semaine,idAgent)
    activate Agenda
    Agenda-->SM: semaine
    deactivate Agenda
    SM-->IHM: semaine
    deactivate SM
else si vue agent
    Agent->IHM:choixJour(date)
    IHM->SM: getJourAgence(date)
    activate SM
    SM->Agenda: getJourAgence(date)
    activate Agenda
    Agenda-->SM: jour
    deactivate Agenda
    SM-->IHM: jour
    deactivate SM
end
Agent->IHM:selectionCellule()
activate IHM
IHM->SM:getPlageHoraire(idAgent,Date)
activate SM
SM->Agenda:getPlageHoraire(idAgent,Date)
activate Agenda
Agenda-->SM:plageHoraire
deactivate Agenda
SM->IHM:plageHoraire
deactivate SM
deactivate IHM
Agent->IHM:choix Action
alt action = créer RDV
    note over IHM,SM:Planification des contacts commerciaux CU6
else action = modifier RDV
    IHM->SM: updateContact(idContact)
    activate SM
    SM->Agenda: updateContact(idContact)
    SM-->IHM: code erreur
    deactivate SM
else action = annuler RDV
   
IHM->SM:annulerContact(idContact,raison)
activate SM
SM->Contact:updateContact(etat,raison)

SM->Contact:deleteTacheElementaire(idContact)
SM-->IHM:code retour
deactivate SM
else action = réaffecter RDV
    IHM->SM: getAllAgents(agence)
    activate SM
    SM->Agences: getAll(agence)
    activate Agences
    Agences-->SM: Agents
    deactivate Agences
    SM-->IHM: agents
    deactivate SM
    IHM->SM: transfererContact(idContact,idAgent)
    activate SM
    SM->Agenda: setAgent(idAgent)
   SM->Agenda:updateContact(idContact)
    SM-->IHM: code erreur
    deactivate SM
end

